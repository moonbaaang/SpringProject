<%@page import="java.math.BigDecimal"%>
<%@page import="org.json.JSONArray"%>
<%@page import="org.json.JSONObject"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="jquery-3.2.1.min.js"></script>
<script>
$(document).ready(function(){

});
</script>
</head>
<body>
<%--
<%
	String faceResult = (String)request.getAttribute("faceResult");
	
	String[] faceInfo = faceResult.split("\"faces\"");
	String[] celeInfo = faceInfo[1].split("\"celebrity\"");
	
	String one = celeInfo[celeInfo.length-1];
	
	int valueIndex = one.indexOf("\"value\":");
	int valueLength = "\"value\"".length();
	int confiIndex = one.indexOf("\"confidence\":");
	int confiLength = "\"confidence\":".length();
	
	out.println(one.substring(valueIndex+valueLength, confiIndex-1) +"<br>");
	out.println(one.substring(confiIndex+confiLength, confiLength+8)+"<br>");
	

%> --%>

<%
	String faceResult = (String)request.getAttribute("faceResult");
	JSONObject obj = new JSONObject(faceResult);
	
	Object imsi = obj.get("faces");
	JSONArray faces = (JSONArray)imsi;
	
	boolean find = false;
	for(Object cele : faces){
		JSONObject celebrity = (JSONObject)((JSONObject)cele).get("celebrity");
		find = true;
		BigDecimal confidence = (BigDecimal)celebrity.get("confidence");
		
		out.println("닮은 연예인 이름 = "+celebrity.get("value") + "닮은 정도 = "
				+ Math.round(confidence.doubleValue()*100)+"%<br>");
	}
	
	String image = request.getParameter("image");
	if(find == false){
		out.println("닮은 연예인을 찾을 수 없습니다.<br>");
	}
	

%>

</body>
</html>