<%@page import="java.math.BigDecimal"%>
<%@page import="org.json.JSONArray"%>
<%@page import="org.json.JSONObject"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="jquery-3.2.1.min.js"></script>
<script>
$(document).ready(function(){

});
</script>
</head>
<body>
<h1> 얼굴 인식 서비스 </h1>

<% 
	String image = (String)request.getParameter("image");
	String faceResult2 = (String)request.getAttribute("faceResult2");
	
	JSONObject obj = new JSONObject(faceResult2);
	JSONArray faces = (JSONArray)obj.get("faces"); //
	
	boolean find = false;
	for(Object one : faces){
		JSONObject roi = (JSONObject)((JSONObject)one).get("roi");
		int x = (int)roi.get("x");
		int y = (int)roi.get("y");
		int width = (int)roi.get("width");
		int height = (int)roi.get("height");
		//String value = (String)celebrity.get("value");
		BigDecimal confidence = (BigDecimal)celebrity.get("confidence");
		
		out.println("닮은 연예인 이름 = " + celebrity.get("value") + ", 닮은 정도 = "
		+ Math.round(confidence.doubleValue()*100) + "%<br>");
	}
	
	String image = request.getParameter("image");
	if (find == false){
		out.println("닮은 연예인을 찾을 수 없습니다.<br>");
	}
%>

<img src="/faceimages/<%=image%>">
</body>
</html>